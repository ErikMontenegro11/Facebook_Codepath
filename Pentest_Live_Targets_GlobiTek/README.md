# Pentesting Globitek
Week 9 Project: Pentesting Live Targets

# Project 8 - Pentesting Live Targets

Time spent: 10 hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

#### Vulnerability #1: SQLi

- First tested the three websites URLs to determine which one had the SQLi vulnerability:
![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/sql1.gif)

- Tested numerous types of blind injection strings and finally discovered the following time-based attack string that caused a delay in response time from the database: 
- Converted following query syntax to be injectable in the url: 
- id=1' and sleep(10)# is converted to 1%27%20and%20sleep(10)%23 

![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/sql2.gif)

- We can see there is a considerable delay before redirect.

#### Vulnerability #2: Session Hijacking

- Used the sesssion_id script provided and opened the page in Firefox to see the users current session ID.  
- Took that cookie and set it to the current cookie being used in Chrome with the same script.  
- Upon opening the blue site in Chrome and clicking Log In, I was not prompted for credentials and was given the staff page.
![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/session1.gif)

## Green

#### Vulnerability #1: User Enumeration
- Using Burp Suite, a known valid username is passed to the login and then an invalid name is passed through and we can compare the html response to both requests.  Below we can see that the developer uses two different classes, 'failed' and 'failure', to display the error messages.
![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/failedcompare.png)

* Here we can see that when a valid user is entered into the login form, the error message text is bolded.  Inspection of the html code for the page verifies this.
![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/failureclass.gif)

* Alternatively, when an invalid username is entered, the error message text is not bolded.
![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/failedclass.gif)

#### Vulnerability #2: Stored XSS
- An XSS vulnerability on this page allows an attacker to inject a script as a comment on the feedback page.  When the logged in user goes to check the feedback back, the script will execute and display an alert window.

![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/xssGreen1.gif)
![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/xssGreen2.gif)

## Red

#### Vulnerability #1: IDOR
 - After examining the 'Find a Salesperson' page on the red site, the url allows for directly accessing non-public pages of employess that used to work for Globitek.  I used Burp Intruder to pass a list of numbers into the '?id=#' field to identify hidden ID numbers.
 -![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/idor1.gif)
 -![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/idor2.gif)
 -![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/idor3.gif)
 
- The other sites defended against this by redirecting back to the 'Territories' page.

#### Vulnerability #2: CSRF
- There is a vulnerabilty with the way the site is validating csrf tokens.  The other two sites seem to implement the defensive layer properly, but the red site does not properly validate when the token is removed from the form that I created. 

- Below I show how Burp helped me identify editable files while navigating through the site as an Admin.  The file tree shows that there is an edit page for each of the salesmen on the page. 
![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/csrf1.png)

- After identifying the potential action pages, I used the HTML to recreate the form used to edit a salesmans data. Removing the csrf_token line enabled the attack site to bypass token authentication.  Hiding the response in an iframe keeps the logged in user from seeing that an attack has taken place.
![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/csrf2.png)

- I used the feedback form the insert the link.  I tried it as an href, hoping that the link would just be hidden behind the anchor text and clicking would redirect, but that didn't quite work as I had hoped.  
![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/csrf3.gif)

- While logged in as Admin, I just opened the attack page in a new window and let the page execute.  When I go a refresh the Admin page, you can see that the Ken Barker has been changed to Donald Duck.
![](https://github.com/ErikMontenegro11/Pentesting_Globitek/blob/master/csrf5.gif)


## Notes

Describe any challenges encountered while doing the work
